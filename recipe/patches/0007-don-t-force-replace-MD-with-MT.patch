From eee04b4beded318a560c6ee52a7492132e282bb3 Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Sun, 11 Dec 2022 21:40:56 +1100
Subject: [PATCH 7/9] don't force-replace /MD with /MT

---
 CMakeLists.txt  | 4 ----
 python/setup.py | 2 +-
 2 files changed, 1 insertion(+), 5 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index f4f7548..d54b008 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -60,10 +60,6 @@ else()
 endif()
 
 if (MSVC)
-  string(REPLACE "/MD" "/MT" CMAKE_CXX_FLAGS_DEBUG          ${CMAKE_CXX_FLAGS_DEBUG})
-  string(REPLACE "/MD" "/MT" CMAKE_CXX_FLAGS_MINSIZEREL     ${CMAKE_CXX_FLAGS_MINSIZEREL})
-  string(REPLACE "/MD" "/MT" CMAKE_CXX_FLAGS_RELEASE        ${CMAKE_CXX_FLAGS_RELEASE})
-  string(REPLACE "/MD" "/MT" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
   add_definitions("/wd4267 /wd4244 /wd4305 /Zc:strictStrings /utf-8")
 endif()
 
diff --git a/python/setup.py b/python/setup.py
index ba4dda8..024cef3 100755
--- a/python/setup.py
+++ b/python/setup.py
@@ -115,7 +115,7 @@ if os.name == 'nt':
         '..\\build\\root_{}\\lib\\sentencepiece_train.lib'.format(arch)
     ]
   else:
-    cflags = ['/std:c++17', '/MT', '/I' + os.environ["LIBRARY_INC"]]
+    cflags = ['/std:c++17', '/MD', '/I' + os.environ["LIBRARY_INC"]]
     libs = [
       # equivalent of -L$PREFIX/lib -lsentencepiece -lsentencepiece_train -lprotobuf
       os.environ["LIBRARY_LIB"] + f"\\{x}.lib"
-- 
2.38.1.windows.1

